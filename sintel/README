Directions for recreating gapless encodes of the Sintel audio:
--------------------------------------------------------------

wget http://media.xiph.org/sintel/Jan_Morgenstern-Sintel-FLAC.zip
unzip Jan_Morgenstern-Sintel-FLAC.zip
sha1sum 1-Snow_Fight.flac
# 0535ca207ccba70d538f7324916a3f1a3d550194  1-Snow_Fight.flac


# Extract the first 31.5 seconds and fade out the last 2.5 to avoid any clicks.
ffmpeg -i 1-Snow_Fight.flac -t 31.5 -af "afade=t=out:st=28:d=2.5" sintel.flac

# Split the extracted segment into ~6.5 second chunks.
ffmpeg -i sintel.flac -acodec pcm_f32le -map 0 -f segment \
       -segment_list out.list -segment_time 6.5 sintel_%d.wav


# As of this writing, FFmpeg doesn't write the correct Gapless information, so
# use the latest LAME encoder directly.  Note: You could also use --nogap with
# LAME and avoid the need to discard anything as files are appended to MSE for
# playback.  LAME will create the files such that they are ready for Gapless
# simply by appending one after another.
lame -V=2 sintel_0.wav sintel_0.mp3
lame -V=2 sintel_1.wav sintel_1.mp3
lame -V=2 sintel_2.wav sintel_2.mp3
lame -V=2 sintel_3.wav sintel_3.mp3
lame -V=2 sintel_4.wav sintel_4.mp3


# Generated by following http://www.apple.com/itunes/mastered-for-itunes/ which
# wants users to convert to an intermediate CAF target first.
afconvert sintel_0.wav sintel_0_intermediate.caf -d 0 -f caff \
          --soundcheck-generate
afconvert sintel_1.wav sintel_1_intermediate.caf -d 0 -f caff \
          --soundcheck-generate
afconvert sintel_2.wav sintel_2_intermediate.caf -d 0 -f caff \
          --soundcheck-generate
afconvert sintel_3.wav sintel_3_intermediate.caf -d 0 -f caff \
          --soundcheck-generate
afconvert sintel_4.wav sintel_4_intermediate.caf -d 0 -f caff \
          --soundcheck-generate
afconvert sintel_0_intermediate.caf -d aac -f m4af -u pgcm 2 --soundcheck-read \
          -b 256000 -q 127 -s 2 sintel_0.m4a
afconvert sintel_1_intermediate.caf -d aac -f m4af -u pgcm 2 --soundcheck-read \
          -b 256000 -q 127 -s 2 sintel_1.m4a
afconvert sintel_2_intermediate.caf -d aac -f m4af -u pgcm 2 --soundcheck-read \
          -b 256000 -q 127 -s 2 sintel_2.m4a
afconvert sintel_3_intermediate.caf -d aac -f m4af -u pgcm 2 --soundcheck-read \
          -b 256000 -q 127 -s 2 sintel_3.m4a
afconvert sintel_4_intermediate.caf -d aac -f m4af -u pgcm 2 --soundcheck-read \
          -b 256000 -q 127 -s 2 sintel_4.m4a


# To use these m4a files directly you can then run them through mp4box --frag,
# for the purposes of this demo we want .adts files though.  NOTE: A recent
# build of FFmpeg is required to set the -write_id3v2 option.
ffmpeg -i sintel_0.m4a -acodec copy -write_id3v2 1 sintel_0.adts
ffmpeg -i sintel_1.m4a -acodec copy -write_id3v2 1 sintel_1.adts
ffmpeg -i sintel_2.m4a -acodec copy -write_id3v2 1 sintel_2.adts
ffmpeg -i sintel_3.m4a -acodec copy -write_id3v2 1 sintel_3.adts
ffmpeg -i sintel_4.m4a -acodec copy -write_id3v2 1 sintel_4.adts
